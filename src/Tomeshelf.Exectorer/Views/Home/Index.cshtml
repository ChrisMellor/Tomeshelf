@{
    ViewData["Title"] = "Tomeshelf Executor";
}

<div class="container py-4 py-lg-5">
    <div class="row g-4 align-items-start">
        <div class="col-lg-5">
            <section class="card h-100 shadow-sm border-0 text-bg-dark">
                <div class="card-header border-0 pb-0">
                    <h2 class="h5 mb-1">Endpoints</h2>
                    <p class="mb-0 small text-secondary">Browse configured endpoints and review metadata.</p>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label" for="endpointSelect">Select Endpoint</label>
                        <select id="endpointSelect" class="form-select form-select-lg"></select>
                    </div>

                    <div id="messageArea" class="alert alert-info d-none mb-3" role="alert"></div>

                    <div class="list-group list-group-flush mb-4">
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Method</span>
                            <span id="endpointMethodDisplay" class="badge rounded-pill text-bg-primary">--</span>
                        </div>
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Target</span>
                            <span id="endpointTarget" class="small text-break text-end">--</span>
                        </div>
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Content Type</span>
                            <span id="bodyContentType" class="badge rounded-pill text-bg-secondary">application/json</span>
                        </div>
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Timeout</span>
                            <span id="timeoutMeta" class="small text-break text-end">HttpClient default</span>
                        </div>
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Schedule</span>
                            <span id="scheduleMeta" class="small text-break text-end">--</span>
                        </div>
                        <div class="list-group-item bg-transparent border-0 d-flex justify-content-between align-items-center px-0">
                            <span class="text-uppercase small text-secondary fw-semibold">Origin</span>
                            <span id="originMeta" class="small text-break text-end">configuration</span>
                        </div>
                    </div>

                    <div id="endpointDescription" class="alert alert-secondary text-light-emphasis small mb-4">
                        Select an endpoint to view details.
                    </div>

                    <div>
                        <h3 class="h6 text-uppercase text-secondary fw-semibold mb-2">Upcoming Executions</h3>
                        <div id="scheduleList" class="d-flex flex-column gap-2"></div>
                    </div>
                </div>
            </section>
        </div>

        <div class="col-lg-7">
            <section class="card shadow-sm border-0 text-bg-dark">
                <div class="card-header border-0 pb-0">
                    <h2 class="h5 mb-1">Manual Execution</h2>
                    <p class="mb-0 small text-secondary">Override request details and trigger an immediate run.</p>
                </div>
                <div class="card-body">
                    <form id="executeForm" autocomplete="off" class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label" for="methodInput">HTTP Method</label>
                            <input id="methodInput" name="methodInput" class="form-control text-uppercase" placeholder="GET" />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label" for="timeoutInput">Timeout (seconds)</label>
                            <input id="timeoutInput" name="timeoutInput" class="form-control" type="number" min="1" placeholder="Optional" />
                        </div>
                        <div class="col-12">
                            <label class="form-label" for="urlInput">Override URL (optional)</label>
                            <input id="urlInput" name="urlInput" class="form-control" placeholder="https://service/path" />
                            <div class="form-text">Leave blank to use the configured endpoint URL.</div>
                        </div>
                        <div class="col-12">
                            <label class="form-label" for="headersInput">Additional Headers</label>
                            <textarea id="headersInput" name="headersInput" class="form-control" rows="3" placeholder="Header-Name: value"></textarea>
                            <div class="form-text">One header per line. Existing configured headers remain in place.</div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label" for="queryInput">Query Parameters</label>
                            <textarea id="queryInput" name="queryInput" class="form-control" rows="3" placeholder="key=value"></textarea>
                            <div class="form-text">One key/value pair per line.</div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label" for="bodyInput">Request Body</label>
                            <textarea id="bodyInput" name="bodyInput" class="form-control" rows="3" placeholder='{"example":"value"}'></textarea>
                            <div id="bodyHelp" class="form-text">Provide JSON payload when required.</div>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary btn-lg w-100">Execute endpoint</button>
                        </div>
                    </form>

                    <div id="executionResult" class="card border-0 bg-body-secondary text-body-emphasis mt-4 d-none">
                        <div class="card-body">
                            <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
                                <div id="resultStatus" class="badge rounded-pill text-bg-secondary fs-6">Status</div>
                                <div id="resultMessage" class="small text-secondary"></div>
                            </div>
                            <div id="resultMeta" class="row row-cols-1 row-cols-md-2 g-3 mt-3"></div>
                            <div class="mt-4">
                                <span class="badge rounded-pill text-bg-primary text-uppercase mb-2">Response body</span>
                                <pre id="resultBody" class="bg-dark-subtle text-body font-monospace rounded p-3 mb-0"></pre>
                            </div>
                            <div class="mt-4">
                                <span class="badge rounded-pill text-bg-primary text-uppercase mb-2">Response headers</span>
                                <div id="resultHeaders" class="table-responsive"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
